---
title: "GitHub Actionsã§Flutter SDKã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹"
emoji: "ğŸ¦…"
type: "tech"
topics: ["flutter", "githubactions", "ci"]
published: true
---

:::message
åˆç¨¿ã§ã¯ã€Œãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šãŒå¿…è¦ã€ã¨æ›¸ãã¾ã—ãŸãŒã€åˆ¥ã«å›ºå®šã—ãªãã¦ã‚‚å‹•ã„ãŸã®ã§ãã®æ—¨ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚
:::

GitHub Actionsã‚’åˆ©ç”¨ã—ã¦Flutterã‚¢ãƒ—ãƒªã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å ´åˆã€ãƒ“ãƒ«ãƒ‰å‰ã«SDKã‚’ã„ã¡ã„ã¡è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¸‹ã®ä¾‹ã§ã¯ãã‚Œã«1åˆ†è¿‘ãã‹ã‘ã¦ãŠã‚Šã€CIã®æ™‚é–“ã‚’ã‹ãªã‚Šåœ§è¿«ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/b95ee16b512c-20220213.png)

GitHub Actionsã«ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ©Ÿèƒ½ãŒå­˜åœ¨ã™ã‚‹ãŸã‚ã€Flutter SDKã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã§CIæ™‚é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã™ã‚‹ã“ã¨ãŒè¦‹è¾¼ã‚ã¾ã™ã€‚

# 1.Cacheã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†

```yaml
#...ç•¥...
'on':
  push:
    branches:
      - master
env:
  flutter_version: '2.10.0'
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: search flutter cache
        uses: actions/cache@v2
        with:
          path: /opt/hostedtoolcache/flutter
          key: ${{ runner.os }}-flutter-install-cache-${{ env.flutter_version }}
      - uses: subosito/flutter-action@v1
        with:
          flutter-version: ${{ env.flutter_version }}
          channel: stable
      - name: Install
        run: flutter pub get
	#...ç•¥...
```

> [subosito/flutter-action](https://github.com/subosito/flutter-action)ã¯v2ãŒå‡ºã¦ã¾ã™ãŒè©¦ã—ã¦ã„ã¾ã›ã‚“

ã¾ãš`env`ã§ç’°å¢ƒå¤‰æ•°ã«SDKã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç•°ãªã‚‹ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ©Ÿèƒ½ã—ãªã„ãŸã‚ã§ã™ã€‚æ¬¡ã«buildã®jobå†…ã§ã€`actions/cache`ã‚’ä½¿ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã‚‚ã—ãƒ’ãƒƒãƒˆã™ã‚Œã°ã“ã“ã ã‘ã§SDKã‚’å…¥æ‰‹ã§ãã¾ã™ã€‚å¤±æ•—ã—ãŸå ´åˆã¯æ¬¡ã®`subosito/flutter-action`ã§é€šå¸¸é€šã‚ŠSDKã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚åŸºæœ¬çš„ã«ã¯2å›ç›®ä»¥é™ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½¿ã‚ã‚Œã‚‹ã¯ãšãªã®ã§ã€é«˜é€ŸåŒ–ãŒè¦‹è¾¼ã‚ã¾ã™ã€‚

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šã—ãªã„å ´åˆ

```yaml
    - name: search flutter cache
      uses: actions/cache@v2
      with:
        path: /opt/hostedtoolcache/flutter
        key: ${{ runner.os }}-flutter-install-cache-stable
    - uses: subosito/flutter-action@v2
      with:
        channel: stable
```

ãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šã—ãªã„å ´åˆã¯ä¸Šã®ã‚ˆã†ã«ãã®è¨˜è¿°ã‚’å‰Šé™¤ã—ã¦ã‚‚å‹•ã‹ã›ã¾ã™ã€‚ãŸã ã—ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®é–¢ä¿‚ä¸Šå¸¸ã«æœ€æ–°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä½¿ãˆã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚(ãªã®ã§å›ºå®šã—ãŸã»ã†ãŒå®‰å¿ƒã‹ã‚‚ï¼Ÿ)

## çµæœ

![](https://storage.googleapis.com/zenn-user-upload/977d01f31e0c-20220213.png)

ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚ŠSDKã®è¨­å®šéƒ¨åˆ†ãŒ50ç§’â†’20ç§’ã¨ã ã„ã ã„30ç§’ç¨‹åº¦ã®æ”¹å–„ã«æˆåŠŸã—ã¾ã—ãŸï¼

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœŸé™ã«ã¤ã„ã¦

https://docs.github.com/en/actions/advanced-guides/caching-dependencies-to-speed-up-workflows

> GitHub will remove any cache entries that have not been accessed in over 7 days.

1é€±é–“ä»¥ä¸Šã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ãã‚Œãªã„ã‚ˆã†ãªã®ã§ã€æ•°æ—¥ã«1åº¦ç¨‹åº¦ä»¥ä¸Šå›ã™ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ã¯æ©æµãŒã‚ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚

# 2.flutter-actionã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’ä½¿ã†

æ›¸ã„ã¦ã„ã‚‹ã¨ãã«æ°—ãŒã¤ã„ãŸã®ã§ã™ãŒ`flutter-action`ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®è¨­å®šãŒã‚ã‚Šã¾ã—ãŸ(è©¦ã—ã¦ã„ã¾ã›ã‚“)

https://github.com/subosito/flutter-action

```yaml
steps:
- uses: actions/checkout@v2
- uses: subosito/flutter-action@v2
  with:
    flutter-version: '2.5.0'
    channel: 'stable'
    cache: true
    cache-key: flutter # optional, change this to force refresh cache
    cache-path: ${{ runner.tool_cache }}/flutter # optional, change this to specify the cache path
- run: flutter --version
```

ã“ã¡ã‚‰ã‚‚å†…éƒ¨ã§ã¯`actions/cache`ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚åŒæ§˜ã®åŠ¹æœãŒã‚ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚

# ã¾ã¨ã‚

- SDKã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã†ã“ã¨ã§CIã®æ™‚é–“ã‚’30ç§’ç¨‹åº¦å‰Šæ¸›ã§ãã‚‹
- 1é€±é–“ä»¥ä¸Šã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ãã‚Œãªã„

# å‚è€ƒ

https://sollematthew.medium.com/github-actions-for-flutter-with-caching-reusable-template-4536c1b67f6a

https://developermemos.com/posts/flutter-tests-github-actions
